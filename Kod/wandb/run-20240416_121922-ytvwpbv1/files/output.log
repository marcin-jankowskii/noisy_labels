GPU dostÄ™pne: NVIDIA GeForce RTX 3090
/media/cal314-1/9E044F59044F3415/Marcin/noisy_labels/Dataset/SegSperm/test
(119, 512, 512)
Mean IoU oneclass (intersection): 0.5423413202212185
IoU per class oneclass (intersection): [0.99533985 0.54234132]
Mean IoU multiclass (intersection): 0.5433811844072639
IoU per class multiclass (intersection): [0.99413973 0.34048681 0.74627556]
Mean IoU oneclass (annotator1): 0.6161045596133524
IoU per class oneclass (annotator1): [0.99531617 0.61610456]
Mean IoU multiclass (annotator1): 0.6282316364944796
IoU per class multiclass (annotator1): [0.99488753 0.49776679 0.75869648]
Mean IoU oneclass (annotator2): 0.5404680478635427
IoU per class oneclass (annotator2): [0.99467808 0.54046805]
Mean IoU multiclass (annotator2): 0.5743527731612461
IoU per class multiclass (annotator2): [0.99405753 0.38860108 0.76010446]
Mean IoU oneclass (union): 0.608146927006163
IoU per class oneclass (union): [0.99465233 0.60814693]
Mean IoU multiclass (union): 0.6467037718822146
IoU per class multiclass (union): [0.99463351 0.52221076 0.77119678]
Mean IoU oneclass (feeling lucky): 0.577653155801092
IoU per class oneclass (feeling lucky): [0.99499204 0.57765316]
Mean IoU multiclass (feeling lucky): 0.5999516711919214
IoU per class multiclass (feeling lucky): [0.99442694 0.44087817 0.75902517]
Traceback (most recent call last):
  File "/media/cal314-1/9E044F59044F3415/Marcin/noisy_labels/Kod/inference.py", line 560, in <module>
    predict(model, test_loader)
  File "/media/cal314-1/9E044F59044F3415/Marcin/noisy_labels/Kod/inference.py", line 477, in predict
    calculate_optimal_threshold(true_masks,soft1, soft2)
  File "/media/cal314-1/9E044F59044F3415/Marcin/noisy_labels/Kod/inference.py", line 266, in calculate_optimal_threshold
    _, pred_masks_multiclass = torch.max(pred_masks_multiclass, 0)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: max() received an invalid combination of arguments - got (numpy.ndarray, int), but expected one of:
 * (Tensor input, *, Tensor out)
 * (Tensor input, Tensor other, *, Tensor out)
 * (Tensor input, int dim, bool keepdim, *, tuple of Tensors out)
 * (Tensor input, name dim, bool keepdim, *, tuple of Tensors out)